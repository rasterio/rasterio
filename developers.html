

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Developers guide &mdash; rasterio 1.0.dev1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="rasterio 1.0.dev1 documentation" href="index.html"/>
        <link rel="up" title="rasterio Python User’s Manual" href="python_manual.html"/>
        <link rel="next" title="Migration Guide for osgeo.gdal users" href="osgeo_gdal_migration.html"/>
        <link rel="prev" title="Migrating to Rasterio 1.0" href="migrating-to-v1.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> rasterio
          

          
          </a>

          
            
            
              <div class="version">
                1.0.dev1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="python_manual.html"><code class="docutils literal"><span class="pre">rasterio</span></code> Python User&#8217;s Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="reading.html">Reading Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_datasets.html">Working with Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing.html">Writing Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="topics.html">General Concepts</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Developers guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rights">Rights</a></li>
<li class="toctree-l3"><a class="reference internal" href="#issue-conventions">Issue Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#design-principles">Design Principles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#git-conventions">Git Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-conventions">Code Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#development-environment">Development Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initial-setup">Initial Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing-gdal">Installing GDAL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-build-requirements">Python build requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing-rasterio">Installing Rasterio</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-tests">Running the tests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#additional-information">Additional Information</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="osgeo_gdal_migration.html">Migration Guide for osgeo.gdal users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html"><code class="docutils literal"><span class="pre">rio</span></code> Command Line User&#8217;s Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_docs.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">rasterio</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="python_manual.html"><code class="docutils literal"><span class="pre">rasterio</span></code> Python User&#8217;s Manual</a> &raquo;</li>
      
    <li>Developers guide</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/developers.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="developers-guide">
<h1>Developers guide<a class="headerlink" href="#developers-guide" title="Permalink to this headline">¶</a></h1>
<p>Welcome to the Rasterio project. Here&#8217;s how we work.</p>
<div class="section" id="code-of-conduct">
<h2>Code of Conduct<a class="headerlink" href="#code-of-conduct" title="Permalink to this headline">¶</a></h2>
<p>First of all: the Rasterio project has a code of conduct. Please read the
CODE_OF_CONDUCT.txt file, it&#8217;s important to all of us.</p>
</div>
<div class="section" id="rights">
<h2>Rights<a class="headerlink" href="#rights" title="Permalink to this headline">¶</a></h2>
<p>The BSD license (see LICENSE.txt) applies to all contributions.</p>
</div>
<div class="section" id="issue-conventions">
<h2>Issue Conventions<a class="headerlink" href="#issue-conventions" title="Permalink to this headline">¶</a></h2>
<p>Rasterio is a relatively new project and highly active. We have bugs, both
known and unknown.</p>
<p>Please search existing issues, open and closed, before creating a new one.</p>
<p>Rasterio employs C extension modules, so bug reports very often hinge on the
following details:</p>
<ul class="simple">
<li>Operating system type and version (Windows? Ubuntu 12.04? 14.04?)</li>
<li>The version and source of Rasterio (PyPI, Anaconda, or somewhere else?)</li>
<li>The version and source of GDAL (UbuntuGIS? Homebrew?)</li>
</ul>
<p>Please provide these details as well as tracebacks and relevant logs.  When
using the <code class="docutils literal"><span class="pre">$</span> <span class="pre">rio</span></code> CLI logging can be enabled with <code class="docutils literal"><span class="pre">$</span> <span class="pre">rio</span> <span class="pre">-v</span></code> and verbosity
can be increased with <code class="docutils literal"><span class="pre">-vvv</span></code>.  Short scripts and datasets demonstrating the
issue are especially helpful!</p>
<p>Rasterio is not at 1.0 yet and issues proposing new features are welcome.</p>
</div>
<div class="section" id="design-principles">
<h2>Design Principles<a class="headerlink" href="#design-principles" title="Permalink to this headline">¶</a></h2>
<p>Rasterio&#8217;s API is different from GDAL&#8217;s API and this is intentional.</p>
<ul class="simple">
<li>Rasterio is a library for reading and writing raster datasets. Rasterio uses
GDAL but is not a &#8220;Python binding for GDAL.&#8221;</li>
<li>Rasterio always prefers Python&#8217;s built-in protocols and types or Numpy
protocols and types over concepts from GDAL&#8217;s data model.</li>
<li>Rasterio keeps I/O separate from other operations. <code class="docutils literal"><span class="pre">rasterio.open()</span></code> is
the only library function that operates on filenames and URIs.
<code class="docutils literal"><span class="pre">dataset.read()</span></code>, <code class="docutils literal"><span class="pre">dataset.write()</span></code>, and their mask counterparts are
the methods that perform I/O.</li>
<li>Rasterio methods and functions should be free of side-effects and hidden
inputs. This is challenging in practice because GDAL embraces global
variables.</li>
</ul>
</div>
<div class="section" id="git-conventions">
<h2>Git Conventions<a class="headerlink" href="#git-conventions" title="Permalink to this headline">¶</a></h2>
<p>We use a variant of centralized workflow described in the <a class="reference external" href="https://git-scm.com/book/en/v2/Distributed-Git-Distributed-Workflows">Git Book</a>.  We
have no 1.0 release for Rasterio yet and we are tagging and releasing from the
master branch. Our post-1.0 workflow is to be decided.</p>
<p>Work on features in a new branch of the mapbox/rasterio repo or in a branch on
a fork. Create a <a class="reference external" href="https://help.github.com/articles/using-pull-requests/">GitHub pull request</a> when the changes are
ready for review.  We recommend creating a pull request as early as possible
to give other developers a heads up and to provide an opportunity for valuable
early feedback.</p>
</div>
<div class="section" id="code-conventions">
<h2>Code Conventions<a class="headerlink" href="#code-conventions" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">rasterio</span></code> namespace contains both Python and C extension modules. All
C extension modules are written using <a class="reference external" href="http://cython.org/">Cython</a>. The
Cython language is a superset of Python. Cython files end with <code class="docutils literal"><span class="pre">.pyx</span></code> and
<code class="docutils literal"><span class="pre">.pxd</span></code> and are where we keep all the code that calls GDAL&#8217;s C functions.</p>
<p>Rasterio supports Python 2 and Python 3 in the same code base, which is
aided by an internal compatibility module named <code class="docutils literal"><span class="pre">compat.py</span></code>. It functions
similarly to the more widely known <a class="reference external" href="https://pythonhosted.org/six/">six</a> but
we only use a small portion of the features so it eliminates a dependency.</p>
<p>We strongly prefer code adhering to <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a>.</p>
<p>Tests are mandatory for new features. We use <a class="reference external" href="https://pytest.org">pytest</a>.</p>
<p>We aspire to 100% coverage for Python modules but overage of the Cython code is
a future aspiration (<a class="reference external" href="https://github.com/mapbox/rasterio/issues/515">#515</a>).</p>
</div>
<div class="section" id="development-environment">
<h2>Development Environment<a class="headerlink" href="#development-environment" title="Permalink to this headline">¶</a></h2>
<p>Developing Rasterio requires Python 2.7 or any final release after and
including 3.4.  We prefer developing with the most recent version of Python
but recognize this is not possible for all contributors.  A C compiler is also
required to leverage <a class="reference external" href="https://docs.python.org/3.5/extending/extending.html">existing protocols</a> for extending Python
with C or C++.  See the Windows install instructions in the <a class="reference external" href="README.rst">readme</a> for more information about building on Windows.</p>
<div class="section" id="initial-setup">
<h3>Initial Setup<a class="headerlink" href="#initial-setup" title="Permalink to this headline">¶</a></h3>
<p>First, clone Rasterio&#8217;s <code class="docutils literal"><span class="pre">git</span></code> repo:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> git clone https://github.com/mapbox/rasterio
</pre></div>
</div>
<p>Development should occur within a <a class="reference external" href="http://docs.python-guide.org/en/latest/dev/virtualenvs/">virtual environment</a> to better isolate
development work from custom environments.</p>
<p>In some cases installing a library with an accompanying executable inside a
virtual environment causes the shell to initially look outside the environment
for the executable.  If this occurs try deactivating and reactivating the
environment.</p>
</div>
<div class="section" id="installing-gdal">
<h3>Installing GDAL<a class="headerlink" href="#installing-gdal" title="Permalink to this headline">¶</a></h3>
<p>The GDAL library and its headers are required to build Rasterio. We do not
have currently have guidance for any platforms other than Linux and OS X.</p>
<p>On Linux, GDAL and its headers should be available through your distro&#8217;s
package manager. For Ubuntu the commands are:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo add-apt-repository ppa:ubuntugis/ppa
<span class="gp">$</span> sudo apt-get update
<span class="gp">$</span> sudo apt-get install gdal-bin libgdal-dev
</pre></div>
</div>
<p>On OS X, Homebrew is a reliable way to get GDAL.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> brew install gdal
</pre></div>
</div>
</div>
<div class="section" id="python-build-requirements">
<h3>Python build requirements<a class="headerlink" href="#python-build-requirements" title="Permalink to this headline">¶</a></h3>
<p>Provision a virtualenv with Rasterio&#8217;s build requirements.  Rasterio&#8217;s
<code class="docutils literal"><span class="pre">setup.py</span></code> script will not run unless Cython and Numpy are installed, so do
this first from the Rasterio repo directory.</p>
<p>Linux users may need to install some additional Numpy dependencies:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo apt-get install libatlas-dev libatlas-base-dev gfortran
</pre></div>
</div>
<p>then:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install -U pip
<span class="gp">$</span> pip install -r requirements-dev.txt
</pre></div>
</div>
</div>
<div class="section" id="installing-rasterio">
<h3>Installing Rasterio<a class="headerlink" href="#installing-rasterio" title="Permalink to this headline">¶</a></h3>
<p>Rasterio, its Cython extensions, normal dependencies, and dev dependencies can
be installed with <code class="docutils literal"><span class="pre">$</span> <span class="pre">pip</span></code>.  Installing Rasterio in editable mode while
developing is very but only affects the Python files.  Specifying the
<code class="docutils literal"><span class="pre">[test]</span></code> extra in the command below tells <code class="docutils literal"><span class="pre">$</span> <span class="pre">pip</span></code> to also install
Rasterio&#8217;s dev dependencies.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install -e .<span class="o">[</span>test<span class="o">]</span>
</pre></div>
</div>
<p>Any time a Cython (<code class="docutils literal"><span class="pre">.pyx</span></code> or <code class="docutils literal"><span class="pre">.pxd</span></code>) file is edited the extension modules
need to be recompiled, which is most easily achieved with:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install -e .
</pre></div>
</div>
<p>When switching between Python versions the extension modules must be recompiled,
which can be forced with <code class="docutils literal"><span class="pre">$</span> <span class="pre">touch</span> <span class="pre">rasterio/*.pyx</span></code> and then re-installing with
the command above.  If this is not done an error claiming that an object <code class="docutils literal"><span class="pre">has</span>
<span class="pre">the</span> <span class="pre">wrong</span> <span class="pre">size,</span> <span class="pre">try</span> <span class="pre">recompiling</span></code> is raised.</p>
<p>The dependencies required to build the docs can be installed with:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install -e .<span class="o">[</span>docs<span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="running-the-tests">
<h3>Running the tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h3>
<p>Rasterio&#8217;s tests live in <code class="docutils literal"><span class="pre">tests</span> <span class="pre">&lt;tests/&gt;</span></code> and generally match the main
package layout.</p>
<p>To run the entire suite and the code coverage report:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> py.test --cov rasterio --cov-report term-missing
</pre></div>
</div>
<p>A single test file:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> py.test tests/test_band.py
</pre></div>
</div>
<p>A single test:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> py.test tests/test_band.py::test_band
</pre></div>
</div>
</div>
</div>
<div class="section" id="additional-information">
<h2>Additional Information<a class="headerlink" href="#additional-information" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>More technical information lives on the wiki.</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/mapbox/rasterio/wiki/Development-Guide">https://github.com/mapbox/rasterio/wiki/Development-Guide</a></li>
<li><a class="reference external" href="https://github.com/mapbox/rasterio/wiki/Exposing-GDAL-Functionality">https://github.com/mapbox/rasterio/wiki/Exposing-GDAL-Functionality</a></li>
<li><a class="reference external" href="https://github.com/mapbox/rasterio/wiki/Cython-and-GDAL">https://github.com/mapbox/rasterio/wiki/Cython-and-GDAL</a></li>
</ul>
<p>The long term goal is to consolidate into this document.</p>
</div></blockquote>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="osgeo_gdal_migration.html" class="btn btn-neutral float-right" title="Migration Guide for osgeo.gdal users" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="migrating-to-v1.html" class="btn btn-neutral" title="Migrating to Rasterio 1.0" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Mapbox.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.dev1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>